#PLCEditor使用指南
**Note：**本文对PLCEditor的使用作了简单的说明，介绍了一下使用方法。适合于对PLC有一定了解的读者进行阅读，如果是初学者建议阅读《PLCEditor使用说明书-详解版》。

##获取资源
目前PLCEditor的发布仅限于内网的发布，读者可以通过如下地址获得我们的资源。该地址下包含了我们的发布信息，可以下载到我们的`最新软件`及`最新使用文档`等。

http://172.16.2.161:81/#!PLCEditor总览.md 

##安装软件
###软硬件要求
下表列出了安装“PLCEditor”软件时需满足的软件和硬件最低要求： 

|硬件/软件|要求|
|--|--|
|处理器类型|Pentium 1 GHz或者更快|
|RAM| 512 MB及以上|
|可用硬盘空间|X86-850 MB;X64-2 GB|
|操作系统| WindowsXP SP3|
||Windows 7 Professional SP1|
||Windows 7（32 位）| 
 
###安装步骤
软件的安装步骤如下：
```
1. 目前的软件不需要安装，只需要将压缩包直接解压到任意路径下即可。
```

软件的打开方式如下：

```
1. 运行解压包下的“GuttaLad.exe”应用程序即可。
```
打开软件后会看到下图所示，说明打开成功。

![PLC1](Resource\Image/PLC1.jpg)

>软件打开后，即可进行项目的创建或打开来进行PLC的编辑工作。

##第一步，新建/打开项目
1. 第一步，新建/打开项目
	* 创建新项目
	
	![PLCEditor新建](Resource\Image\PLCEditor新建.jpg)
	
	创建项目的步骤如下：
	
	```
		1. 在“文件”（F）菜单中，选择“新建”（N）命令。
		2. 如遇到当前项目未保存的情况，依照对话框提示执行操作即可。
	```
		
	* 打开原有项目
	
	打开原有项目的时候，会存在两种情况。一种是从备份处用一些移动储存设备，例如:U盘、移动硬盘等将已经存在的项目文件拷贝到本机上以供PLCEditor使用。另外一种方式是，通过PLCEditor的下载功能在线从服务器下载以有项目文件的移动。（具体如何下载可《专题-上传下载》）
	
	![打开项目](Resource\Image\打开.jpg)
	
	打开项目的步骤如下：
	
	```
		1. 在“文件”（F）菜单中，选择“打开”（O）命令。
		2. 在弹出对话框中选择需要打开的原有项目。
	```
	
	![导入xml](Resource\Image\导入xml.jpg)
		
	另外利用.xml项目文件导入也可以打开项目，步骤如下:
		
	```
		1. 在“文件”（F）菜单中，选择“导入TC6XML文件”（I）命令。
		2. 在弹出对话框中选择需要打开的原有项目。
	```
	
>当成功创建出一个项目之后，接着要做的就是对这个项目进行编辑。项目编辑的前提是要有数据，有变量。所以在创建好项目之后，需要完成的下一个步骤是变量/系统符号的配置。
	
##第二步，配置变量/系统符号
	
* 全局变量和局部变量
	
	如果在程序块中用到全局变量或者局部变量，首先要在`全局变量表`和`关联变量表`中添加上变量。
	
	![全局变量表](Resource\Image\全局变量表.jpg)
	
	![关联变量表](Resource\Image\关联变量表.jpg)
	
* 程序块中若用到Phoenix寻址，必须在系统符号中添加。目前系统符号的添加必须通过一个.xml格式文件进行导入。导入的步骤如下：
	
	![导入导出符号](Resource\Image\导入导出符号.jpg)
	
	```
		1. 在“文件”（F）菜单中，选择“导入符号”命令。
		2. 在弹出对话框中选择需要打开的.xml文件。
	```
		
	文件的编写标准如下：
	
	```
		<?xml version="1.0" encoding="utf-16"?>
		<Items>
			<Item path="Phoenix.G.Channels[0].Auto.Load" type="System.Boolean" io="Input" level="Normal" category="Default" assembly="Weihong.Phoenix.Channel" namespace="Weihong.Phoenix.Channel" owner="Weihong.Phoenix.Channel.Auto"/>
		<Items>
		
		说明：每使用一个Phoenix寻址必须添加一个Item。
		path：寻址路径
		type：数据类型
		io	：读写情况 Input表示只写，Output表示只读，InOut表示可读可写
		level：定时器级别
		assembly：定义数据的类型 所在的程序集
		namespace：定义数据的类型 的命名空间
		owner：定义数据的类型 全名称(包含命名空间)				
	```
	
>当将变量都定义好之后，就可以正式编写梯形图PLC逻辑了，就来到了第三步，梯形图编辑。

##第三步，编辑梯形图
	
	到这里就开始了梯形图的正式编辑，该部分的具体内容会在《梯形图指令及编辑》部分详细说明。

>梯形图编辑的完成之后，最终的目的是让软件能够使用这段逻辑代码。而软件使用的方式是动态链接库，也就是.dll格式的文件。所以接下来要准备将逻辑代码变成.dll格式文件了，这个过程是编译。
	
##第四步，配置编译信息
	
在编译之前，我们首先要做的是对编译器做一些配置工作，这样才能成功地编译。
	
```
	1. 在“PLC”菜单中，选择“编译配置”命令。
```
		
执行上述操作能看到如下图对话框
		
![编译配置](Resource\Image\编译配置.jpg)
	
1. 选择编译器位置
				
2. 设置编译器命令行参数
	* 命令行参数说明
					
		* /o:outfile

		/o:为参数前缀，outfile为参数值，此参数为生成的`Plc逻辑程序集`路径及名称，支持相对路径和绝对路径。
			
		例如：想在C盘Custom文件夹下生成名为Ncstudio.plc的文件则应写为
			
		```
			/o:C:\Custom\Ncstudio.plc	
		```
		如果该参数不指定，默认情况下，会将生成的程序集命名为plc.dll并保存到`选定的编译器(目前为Tc6ToCSharp.exe)`所在目录。
			
		* /t:tc6file
			
		/t:为参数前缀，tc6file为参数值，此参数为`由Plc梯形图图形化语言翻译过来的的tc6格式文件`的路径及名称，支持相对路径和绝对路径。
			
		例如：想编译C盘Custom文件夹下名为tc6.xml文件则应写为
			
		```
			/t:C:\Custom\tc6.xml	
		```
		如果该参数不指定，默认情况下，会使用`选定的编译器(目前为Tc6ToCSharp.exe)`所在目录中的tc6.xml文件。
			
		* /d:directory
		
		/d:为参数前缀，directory为参数值，此参数为应用程序对生成的CSharp代码进行编译时所需资源目录，目录中应包含编译所需的所有资源。
			
		例如：想编译时所需资源在C盘Custom文件夹下
			
		```
			/t:C:\Custom	
		```
			
		如果该参数不指定，默认情况下，会使用`选定的编译器(目前为Tc6ToCSharp.exe)`所在目录。所有的命令行参数必须在同一行且用一个空格“ ”分隔。
			
	3. 设置PLC梯形图图形化语言翻译出来的TC6XML格式文件的输出路径。
	
>在编译配置完成后，我们就可以进行最后的工作————编译。
		
##第五步，进行编译

![编译](Resource\Image\编译.jpg)
	
```
	1. 在“PLC”菜单中，选择“编译（B）”命令，即可执行编译。
```
	
##第六步，供数控软件使用
若想要在数控系统中使用上PLC，必须将编译生成的.dll格式文件放置到数控软件对应的目录下。这个工作可以有这样两种办法来实现:

1.用移动储存设备，例如:U盘，移动硬盘等拷贝到数控软件下去。

2.通过与服务器进行连接，通过PLCEditor提供的“上传功能”来将.dll文件上传到服务器上使用。（见：专题-上传下载）

>至于拷贝到拿个目标，放置在哪里，这个是数控软件自身的规定，在此不作赘述。

##第七步，调试PLC的运行情况	
当编写好PLC并且正常运行的时候，若想监控PLC的运行情况，原来我们只能通过外部端口和一些表象来观察。现在PLCEditor提供了一种在线监控调试功能。

此功能在服务器与客户端连接的情况下，可以监控PLC的运行情况。从而方便了我们的调试和问题检查。

具体的实现方式可见：专题-监控调试。

##专题-连接服务器
1. 第一步，配置连接信息

	为了保证连接的正常进行，我们首先需要确保连接设定配置正确，所以先为读者介绍如何配置连接信息。

	![通讯](Resource\Image\通讯.jpg)
	
	```
		1. 双击项目树下的“通讯”按钮，弹出通讯配置对话框。
		2. 将对话框中的内容填写完整，点击确定。
	```
	
	通讯配置对话框如下：
		
	![通讯配置](Resource\Image\通讯配置.jpg)
		
	IP地址： 保持与服务器的IP地址一致。目前服务器地址默认为127.0.0.1。设置该值即可。
		
	通讯端口：目前端口为2040；监控端口：目前端口为2041。
	通讯端口和监控端口在服务器启动时已经确定，在PlcEditor发布时已经完成设置，通常不需要进行修改。在PlcEditor和服务器代码版本不匹配时可能需要进行修改。
	
2. 第二步，进行连接

	![连接](Resource\Image\连接.jpg)
		
	连接的步骤如下：
	 
	```
		1. 在“调试（D）”菜单中，选择“连接”（C）命令。
		2. 在弹出对话框中输入密码，密码为123，即可连接成功。
	```
##专题-上传下载

	![上传下载](Resource\Image\上传下载.jpg)
	
	在线状态下，我们可以将设备上的Plc项目文件下载到本地，操作步骤如下：
	
	```
		2. 在“PLC”菜单中，选择“从设备下载（D）” 
	```

    下载完成后PlcEditor会自动打开方便进行编辑，编辑好代码后，可以将本地编译的plc逻辑代码程序集上传到连接中的软件目录,操作步骤如下:
	
	```
		1. 在“PLC”菜单中，选择“上传到设备（U）”。
	```

    在上传完成后软件会自动重启并应用新上传的plc程序集。

##专题-监控调试

1.运行停止

![运行停止](Resource\Image\运行停止.jpg)
	
与服务器连接成功后，可以在PLCEditor这一客户端来控制服务器上PLC的执行情况。通过如下操作，即可控制PLC是否扫描。
```
	1. 在“PLC”菜单中，选择“运行（R）”，则PLC开启扫描
	2. 在“PLC”菜单中，选择“停止（S）”，则PLC停止扫描。
```
	
2. 监控调试

PLC在运行过程中，我们可以通过PLCEditor上的监控调试功能来监控PLC的运行情况。为更快更好地进行测试和排查问题提供了极大的方便。使用的过程如下:
	
连接成功后，菜单栏监控图标有效
	
![通讯配置](Resource\Image\监控.jpg)
	
此时单击监控图标可以开始监控。开始监控后可以在梯形图中查看变量值和元件导通状态，可以在状态表中添加变量路径以监控变量的值。











