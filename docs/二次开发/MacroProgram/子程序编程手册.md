子程序使用说明书
======================

**NOTE:** 本文主要介绍子程序该如何使用，提供一些帮助。

##变量
* 局部变量

	* 用`local`来定义局部变量
	
	局部变量只在被声明的代码块内有效。代码块指：一个函数体，或者一个chunk（变量被声明的那个文件或者文件串）
		
* 全局变量

	* 全局变量不需要声明
	
	给一个变量赋值后即创建了这个全局变量，访问一个没有初始化的全局变量也不会出错，只不过得到的结果是:nil
* Phoenix寻址
见F:\Phoenix\Doc\基础框架\容器和寻址\《Phoenix容器定义和寻址规则》

##算术和逻辑
见[《Programming in Lua》](Lua/ProgrammingInLua.pdf)第3章。

##赋值
见[《Programming in Lua》](Lua/ProgrammingInLua.pdf)第4章。

##控制结构
见[《Programming in Lua》](Lua/ProgrammingInLua.pdf)第4章。

##数控指令
### G指令

|功能|原有G指令|现存函数|功能|原有G指令|现存函数|
|:------|:-----|:------|:-----|:-----|:-----|
|点定位|G00  |MoveTo   |选用3号工件坐标系|G56|WorkCoor2|
|直线插补 |G01|LineTo   |选用4号工件坐标系|G57|WorkCoor3|
|顺时针圆弧插补|G02  |CwTo |选用5号工件坐标系|G58|WorkCoor4|
|逆时针圆弧插补|G03  |CcwTo|选用6号工件坐标系|G59|WorkCoor5|
|暂停|G04  |Pause    |子程序调用|G65|         |
|XY平面选择|G17  |PlaneXY  |旋转功能开|G68|RotateOn  |
|ZX平面选择|G18  |PlaneZX  |旋转功能关|G69|RotateOff|
|YZ平面选择|G19  |PlaneYZ  |英制加工单位|G70|Inch|
|英制单位加工|G20  |Inch     |公制加工单位|G71|Metric|
|公制单位加工|G21  |Metric   |高速深孔往复排屑钻循环|G73|Fc73|
|自动返回参考点|G28  |AHome    |左手攻牙循环|G74|Fc74|
|圆周钻孔循环|G34  |         |精细镗孔循环|G76|Fc76|
|角度直线钻孔循环|G35  |         |取消固定循环功能|G80|    |
|圆弧钻孔循环|G36  |         |一般钻孔循环|G81|Fc81|
|棋盘孔循环|G37  |         |孔底暂停钻孔循环|G82|Fc82|
|取消刀具半径补偿|G40  |CrcOff   |深孔往复排屑循环|G83|Fc83|
|刀具半径左补偿|G41  |CrcL     |右手攻牙循环|G84|Fc84|
|刀具半径右补偿|G42  |CrcR     |钻孔循环|G85|Fc85|
|刀具长度正向补偿|G43  |CrcP     |高速钻孔循环|G86|Fc86|
|刀具长度负向补偿|G44  |CrcN     |背面精细镗孔循环|G87|Fc87|
|取消刀具长度补偿|G49  |ClcOff   |镗孔循环|G88|Fc88|
|取消比例功能|G50  |ScaleOff |孔底暂停镋孔循环|G89|Fc89|
|启用镜像功能|G50.1|MirrorOn |绝对坐标编程|G90|CoorAbs|
|启用比例功能|G51  |ScaleOn  |相对坐标编程|G91|CoorRel|
|取消镜像功能|G51.1|MirrorOff|设置工件坐标偏置|G92|CoorSet|
|使用机械坐标系|G53|MCoorS|一次循环结束，复归到初始点|G98|FcToB|
|选用1号工件坐标系|G54|WorkCoor0|一次循环结束，复归到参考点|G99|FcToR|
|选用2号工件坐标系|G55|WorkCoor1|

### M指令

|功能|原有M指令|现存函数|
|:-----|:------|:-----|
|程序停止|M00|      |
|计划停止|M01|      |
|程序结束|M02|      |
|主轴顺时针转动|M03|SpindlePOn|
|主轴逆时针转动|M04|SpindleNOn|
|主轴停止|M05|SpindleOff|
|换刀|M06|      |
|冷却液开|M08|CutFOn|
|冷却液关|M09|CutFOff|
|主轴夹紧|M10| |
|主轴松开|M11| |
|子程序返回|M17| |
|程序结束|M30| |
|子程序调用|M98| |
|循环|M99||

###扩展G指令

|功能|原有G指令|现存函数|
|:------|:------|:------|
|强制进给倍率100%|G903|Frp100|
|条件移动|G904|      |
|强制进给速度|G905|      |
|同步指令|G906|Syn|
|以最短路径运动|G907| |
|强制以角度为单位编程|G908| |
|写轴配置数据|G916| |
|计算过信号触发点减速距离|G919| |
|指定当前坐标系当前点工件坐标值|G921| |
|指定工件坐标系原点值|G922| |
|设置刀具偏置值|G923| |
|临时工件坐标系设定|G992|   |

###扩展M指令

|功能|原有M指令|现存函数|
|:------|:------|:------|
|各模块间传递字符串信息|M801| |
|各模块间传递整数信息|M802| |
|直接输出指令|M901| |
|回零结束指令|M902| |
|更改当前刀具号|M903| |

###其他指令

|功能|原有指令|现存函数|
|:-----|:------|:-----|
|速度设置|F|F|
|转速设置|S|S|
|刀具更改|T|T|
|关闭缓冲区||CloseBuffer|
|开启缓冲区||OpenBuffer|

##软件交互语句

|功能|现存函数|
|:------|:-----|
|发送消息日志|Msg|
|发送错误日志|Error|
|发送警告日志|Warning|



